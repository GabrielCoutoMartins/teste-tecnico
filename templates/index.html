<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
  rel="stylesheet">
    <script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js">
</script>
    <title>Tasks</title>
</head>
<body>
    <nav class="navbar navbar-light bg-light mb-4">
        <a class="navbar-brand" href="/">Tasks</a>
    </nav>
    <div class="container">
        <section class="card">
            <div>
                <table class="table table-striped table-hover mb-0 ">
                    <form method="POST" class="row g-2 align-items-center" action="/buscarPorTitulo">
                    <br>
                        <form method="POST" action="/buscarPorTitulo" class="d-flex align-items-center">
                            <input type="text" class="form-control mx-2 mb-2" style="width: 250px" placeholder="Pesquisar Título" name="titulo">
                        <div class="col-auto">
                            <button type="submit" class="btn btn-info mx-2">Buscar</button>
                        </div>
                    </form>
                    <br>
                    <thead>
                        <tr>
                            <th>Titulo</th>
                            <th>Descrição</th>
                            <th>Status</th>
                            <th>Criado Em</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .}}
                        <tr>
                            <td>{{.Titulo}}</td>
                            <td>{{.Descricao}}</td>
                            <td>{{.Status}}</td>
                            <td>{{.CridoEm}}</td>
                            <td><a href="/editar?id={{.Id}}" class="btn btn-info">Editar</a></td>
                            <td>
                                <button
                                    class="btn btn-danger"
                                    data-bs-toggle="modal"
                                    data-bs-target="#deleteModal"
                                    data-id="{{.Id}}">
                                    Deletar
                                </button>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </section>
        <div class="mt-4">
            <a href="/novaTask" class="btn btn-primary">Nova Task</a>

    </div>
    <!-- Modal de confirmação de exclusão -->
<div class="modal fade" id="deleteModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Confirmar exclusão</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        Tem certeza que deseja deletar esta task?
        <p class="text-danger mt-2">Essa ação não pode ser desfeita.</p>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Cancelar
        </button>

        <a href="#" id="confirmDeleteBtn" class="btn btn-danger">
          Deletar
        </a>
      </div>

    </div>
  </div>
</div>

<script>
const deleteModal = document.getElementById('deleteModal')
const confirmBtn = document.getElementById('confirmDeleteBtn')

deleteModal.addEventListener('show.bs.modal', function (event) {
  const button = event.relatedTarget
  const id = button.getAttribute('data-id')

  confirmBtn.href = `/deletar?id=${id}`
})
</script>
</body>

</html>